---
layout: post
title: "annotaterb v4.20.0 commit log æµã—èª­ã¿"
image: https://odentakashi.github.io/public/images/mini_annotaterb_schematic.png
date: 2025-10-19 12:52
---

annotaterb v4.20.0 commit logã‚’æµã—ã§èª­ã¿ã¾ã—ãŸ ğŸ‘€ <br>
èª­ã‚“ã ã‚³ãƒŸãƒƒãƒˆã¯ä¸‹è¨˜ã§ã™ã€‚

- [Comparing v4\.19\.0\.\.\.v4\.20\.0 Â· drwl/annotaterb](https://github.com/drwl/annotaterb/compare/v4.19.0...v4.20.0)


## Bump actions/checkout from 4 to 5 #257
`actions/checkout`ã‚’ V5 ã« update ã—ã¦ã„ã‚‹ dependabot ã«ã‚ˆã‚‹ PR ã§ã™ã€‚<br>

refs: [Bump actions/checkout from 4 to 5 ](https://github.com/drwl/annotaterb/pull/257)

## chore: introduce switchable DB environment for specs #262
spec ã§ä½¿ç”¨ã—ã¦ã„ã‚‹ dummy app ã«ã€DB è¨­å®šã‚’ã‚·ãƒ³ã‚°ãƒ«ï¼ãƒãƒ«ãƒæ§‹æˆã§åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ä»•çµ„ã¿ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚<br>
`SINGLE_DB_TEST` ãŒ `true` ã®å ´åˆã¯ã‚·ãƒ³ã‚°ãƒ« DB ç’°å¢ƒã€`false` ã¾ãŸã¯ `nil` ã®å ´åˆã¯ãƒãƒ«ãƒ DB ç’°å¢ƒã¨ã—ã¦å‹•ä½œã—ã¾ã™ã€‚<br>

ã“ã®å¤‰æ›´ã®èƒŒæ™¯ã¨ã—ã¦ã€ã“ã‚Œã¾ã§ã¯ã€Œãƒãƒ«ãƒ DB ç’°å¢ƒã§ã®ã¿å‹•ä½œã™ã‚‹å®Ÿè£…ã€ã‚’è¿½åŠ ã™ã‚‹éš›ã«ã€ã‚·ãƒ³ã‚°ãƒ« DB ç’°å¢ƒã§ã¯å‹•ä½œã—ãªã„ã“ã¨ã‚’ç¢ºèªãƒ»æ‹…ä¿ã™ã‚‹æ‰‹æ®µãŒå­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚<br>
ãã®ãŸã‚ã€ä»Šå›ã“ã®åˆ¶å¾¡æ©Ÿæ§‹ã‚’å°å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã“ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒãƒãƒ«ãƒDBã«ãªã£ã¦ã„ã¾ã™ã€‚

refs: [chore: introduce switchable DB environment for specs \#262](https://github.com/drwl/annotaterb/pull/262)

## refactor(test): Default to single-DB environment for tests #264
> chore: introduce switchable DB environment for specs #262

ä¸Šè¨˜ã®å¤‰æ›´ã§ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒã® dummy app ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒãƒ«ãƒDBæ§‹æˆã«ãªã‚‹ã‚ˆã†åˆ¶å¾¡ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚<br>
ã—ã‹ã—ãã®çµæœã€ãƒãƒ«ãƒDBç’°å¢ƒã§ã®ã¿å®Ÿè¡Œã•ã‚Œã‚‹ annotate å‡¦ç†ãŒã€ã‚·ãƒ³ã‚°ãƒ«DBã‚’å‰æã¨ã™ã‚‹ç®‡æ‰€ã«ã‚‚å½±éŸ¿ã—ã¦ã—ã¾ã†å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚<br>

ã“ã®ãŸã‚ã€æœ¬å¤‰æ›´ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’è¦‹ç›´ã—ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒã¯ã‚·ãƒ³ã‚°ãƒ«DBæ§‹æˆã‚’åŸºæœ¬ã¨ã—ã€å¿…è¦ãªå ´åˆã®ã¿ãƒãƒ«ãƒDBã‚’æœ‰åŠ¹åŒ– ã™ã‚‹ã‚ˆã†åˆ¶å¾¡ã‚’ä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚

refs: [refactor\(test\): Default to single\-DB environment for tests by OdenTakashi Â· Pull Request \#264 Â· drwl/annotaterb](https://github.com/drwl/annotaterb/pull/264)
## Escape column comment newlines when using "rightmost" value for position_of_column_comment option #263
ã‚«ãƒ©ãƒ ã«æ”¹è¡Œã‚’å«ã‚€ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ã„ãŸå ´åˆã€æ”¹è¡Œæ–‡å­—ãŒæ­£ã—ãã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œãšã€å‡ºåŠ›æ™‚ã«ã‚³ãƒ¡ãƒ³ãƒˆãŒé€”ä¸­ã§æ”¹è¡Œã•ã‚Œã¦ã—ã¾ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚<br>

```rb
#  notes                                        :text(55)         not null     Notes.
May include things like notes.
```

ã“ã®ãŸã‚ã€æ”¹è¡Œæ–‡å­—ã‚’ \n ã¨ã—ã¦ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ ã—ã€ã‚³ãƒ¡ãƒ³ãƒˆãŒ1è¡Œå†…ã«æ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚

refs: [Escape column comment newlines when using â€œrightmostâ€ value for position_of_column_comment option #263](https://github.com/drwl/annotaterb/pull/263)

## Honor --frozen option in routes #265
`--frozen` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä½¿ç”¨æ™‚ã« annotation ã«å¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã®ãŒæ­£ã—ã„æŒ™å‹•ã§ã™ãŒã€ã“ã‚Œã¾ã§ä¾‹å¤–ãŒç™ºç”Ÿã—ã¦ã„ãªã‹ã£ãŸãŸã‚ã€æ­£ã—ã raise ã•ã‚Œã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

refs: [Honor \-\-frozen option in routes \#265](https://github.com/drwl/annotaterb/pull/265)

## Update README.md #268
README ã® typo ä¿®æ­£ã§ã™ã€‚

refs: [Update README\.md \#268](https://github.com/drwl/annotaterb/pull/268)

## fix: resolve YAML syntax error in update_config generator #269
rails g annotate_rb:update_config ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ç¾åœ¨ã®è¨­å®šã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã®å·®åˆ†ã‚’æ¤œçŸ¥ã—ã€å¿…è¦ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ .annotaterb.yml ã«è¿½è¨˜ã™ã‚‹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚<br>

```rb
rails g annotate_rb:update_config
```

ã—ã‹ã—ã€å·®åˆ†ãŒå­˜åœ¨ã—ãªã„å ´åˆã§ã‚‚ç©ºã® {} ãŒ YAML ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½è¨˜ã•ã‚Œã¦ã—ã¾ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚<br>
ãã®ãŸã‚ã€å·®åˆ†ãŒãªã„å ´åˆã¯æ—©æœŸã« return ã—ã¦è¿½è¨˜ã‚’è¡Œã‚ãªã„ã‚ˆã†ä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚

refs: [fix: resolve YAML syntax error in update\_config generator \#269](https://github.com/drwl/annotaterb/pull/269)

## Bump github/codeql-action from 3 to 4 #277
CodeQL Action ã‚’ V4 ã¸ã¨ update ã—ã¦ã„ã¾ã™ã€‚

refs: [Bump github/codeql\-action from 3 to 4 \#277](https://github.com/drwl/annotaterb/pull/277)

## fix: position-of-column-comment option #275
`position-of-column-comments` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå†…éƒ¨çš„ã« `position-of-column-comment` ã¨ã—ã¦æ‰±ã‚ã‚Œã¦ã„ãŸãŸã‚ã€æŒ‡å®šã—ã¦ã‚‚æ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚<br>
ã“ã®å•é¡Œã‚’ä¿®æ­£ã—ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæ­£ã—ã position-of-column-comment ã¨ã—ã¦å‡¦ç†ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

refs: [fix: position\-of\-column\-comment option \#275](https://github.com/drwl/annotaterb/pull/275)

## feat: Add database name to annotations in multi-DB environments #272
ãƒãƒ«ãƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒã§ã¯ã€ã‚¹ã‚­ãƒ¼ãƒã‚³ãƒ¡ãƒ³ãƒˆã ã‘ã‚’è¦‹ã¦ã‚‚ã€Œãƒ¢ãƒ‡ãƒ«ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã©ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å±ã—ã¦ã„ã‚‹ã®ã‹ã€ãŒåˆ†ã‹ã‚Šã¥ã‚‰ãã€é–‹ç™ºè€…ãŒãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ã¨å‹˜é•ã„ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã—ãŸã€‚<br>
ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ãƒ–ãƒ­ãƒƒã‚¯ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã‚’è¡¨ç¤ºã™ã‚‹è¡Œã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚<br>

å…·ä½“çš„ã«ã¯ã€ãƒãƒ«ãƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã« Database name: è¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```rb
# == Schema Information
#
# Table name: tasks
# Database name: second_database
#
# ...
```

ä¸€æ–¹ã€ã‚·ãƒ³ã‚°ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒã§ã¯å†—é•·ã«ãªã‚‹ãŸã‚ã€ã“ã®è¡Œã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

refs: [feat: Add database name to annotations in multi\-DB environments \#272](https://github.com/drwl/annotaterb/pull/272)
